# Review: td-bf126c closed tasks (2026-02-01)

## Scope
- Reviewed closed tasks in epic `td-bf126c` against `docs/sync-plan-03-merged.md` and `docs/sync-mvp-testing-spec.md`.
- Code areas: `internal/sync/*`, `test/syncharness/*`, `internal/api/*`, `internal/db/*`, `cmd/sync.go`, `cmd/link.go`, `cmd/dependencies.go`, `cmd/create.go`.

## Tests
- `go test ./...`

## Fixes applied during review
- Added action_log entries for dependency additions/removals in:
  - `td create` (`cmd/create.go`)
  - `td dep add/rm` and backward-compat `td dep <issue> <depends-on>` (`cmd/dependencies.go`)
  - `td link --depends-on` (`cmd/link.go`)
- Updated dependency command tests to reflect new logging helper signature (`cmd/dependencies_test.go`).

## Findings (bugs filed)
- **td-1dc72b** — Apply should ignore unknown payload fields per spec. Current apply path inserts all keys, so unknown columns cause SQLite errors and events are skipped (see TestSchemaVersionMismatch comment in `test/syncharness/harness_test.go`). This breaks forward/backward compatibility.
- **td-56e86d** — Legacy action_log entries for composite-key entities (board positions, dependencies, file links) are not rewritten after deterministic ID + repo-relative migrations. Unsynced legacy rows may push stale entity_id/file_path values and create duplicates or absolute-path file links on other devices.

## Notes
- Sync library, server API, and harness tests otherwise align with the phase 0/1/3 closed task specs and pass all tests.
